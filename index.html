<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <!-- 标题 -->
    <title>QQ Web Lite</title>

    <!-- 页面信息 -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#313D43">
    <meta name="referrer" content="always" id="referrer">
    <!-- 应用信息 -->
    <link rel="manifest" href="manifest.json">
    <!-- 框架样式依赖 -->
    <link rel="stylesheet" href="https://api.stapxs.cn/css/color-light.css">
    <link rel="stylesheet" href="https://api.stapxs.cn/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="https://api.stapxs.cn/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://api.stapxs.cn/font/fira_code.css">
    <link rel="stylesheet" href="https://api.stapxs.cn/css/style.css">
    <!-- 页面样式依赖 -->
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/view.css">
    <link rel="stylesheet" href="css/msg.css">
    <!-- 外部功能依赖 -->
    <script src="https://api.stapxs.cn/js/main.js"></script>
    <script src="src/js/clipboard.min.js"></script>
    <!-- 页面功能依赖 -->
    <script src="js/util.js"></script>
    <script src="js/impl/notice_fun.js"></script>
    <script src="js/impl/msg_fun.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/ws.js"></script>
</head>

<body style="background: var(--color-bg);color: var(--color-font)">
<div style="display: flex;flex-direction: column;height: 100vh;overflow: hidden;">
    <div class="container-lg" style="flex: 1;">
        <div class="main-view" id="main-view">
            <!-- 顶部控制组件 -->
            <div class="controller">
                <div class="ss-card back-btn" title="返回" id="change-view-btn" data-icon="right" onclick="changeView()">
                    <svg style="transition: transform .3s;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path d="M64 448c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L41.38 118.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l160 160c12.5 12.5 12.5 32.75 0 45.25l-160 160C80.38 444.9 72.19 448 64 448z"/></svg>
                </div>
                <div class="ss-card" title="登录" onclick="showLoginPan(true)" id="login-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M344.7 238.5l-144.1-136C193.7 95.97 183.4 94.17 174.6 97.95C165.8 101.8 160.1 110.4 160.1 120V192H32.02C14.33 192 0 206.3 0 224v64c0 17.68 14.33 32 32.02 32h128.1v72c0 9.578 5.707 18.25 14.51 22.05c8.803 3.781 19.03 1.984 26-4.594l144.1-136C354.3 264.4 354.3 247.6 344.7 238.5zM416 32h-64c-17.67 0-32 14.33-32 32s14.33 32 32 32h64c17.67 0 32 14.33 32 32v256c0 17.67-14.33 32-32 32h-64c-17.67 0-32 14.33-32 32s14.33 32 32 32h64c53.02 0 96-42.98 96-96V128C512 74.98 469 32 416 32z"/></svg>
                </div>
                <div style="flex: 1"></div>
                <div class="ss-card" title="白色模式" id="color-changer" data-color="light" onclick="btnChangeColor()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
                </div>
            </div>
            <!-- 主框架 -->
            <div class="msg-view ss-card" id="msg-view">
                <!-- 左列表 -->
                <div class="friend-list" id="friend-list">
                    <!-- 用户信息区 -->
                    <div class="main-body" style="height: 90px;overflow: hidden;background: var(--color-main);border-radius: 7px 7px 0 0;padding: 20px;display: flex;color: var(--color-font-1-r);">
                        <img id="main-src" style="width: 50px;height: 50px;border-radius: 100%;background: var(--color-card-1);">
                        <div style="margin-left: 15px;flex: 1;">
                            <p id="main-name" style="font-size: 1.1rem;margin-bottom: 0;font-weight: bold;"></p>
                        </div>
                        <div style="width: 50px;height: 50px;background: #0000002e;border-radius: 100%;padding: 13px 14px;">
                            <svg style="fill: var(--color-font-1-r);width: 20px;margin-top: -3px;margin-left: 1px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M495.9 166.6C499.2 175.2 496.4 184.9 489.6 191.2L446.3 230.6C447.4 238.9 448 247.4 448 256C448 264.6 447.4 273.1 446.3 281.4L489.6 320.8C496.4 327.1 499.2 336.8 495.9 345.4C491.5 357.3 486.2 368.8 480.2 379.7L475.5 387.8C468.9 398.8 461.5 409.2 453.4 419.1C447.4 426.2 437.7 428.7 428.9 425.9L373.2 408.1C359.8 418.4 344.1 427 329.2 433.6L316.7 490.7C314.7 499.7 307.7 506.1 298.5 508.5C284.7 510.8 270.5 512 255.1 512C241.5 512 227.3 510.8 213.5 508.5C204.3 506.1 197.3 499.7 195.3 490.7L182.8 433.6C167 427 152.2 418.4 138.8 408.1L83.14 425.9C74.3 428.7 64.55 426.2 58.63 419.1C50.52 409.2 43.12 398.8 36.52 387.8L31.84 379.7C25.77 368.8 20.49 357.3 16.06 345.4C12.82 336.8 15.55 327.1 22.41 320.8L65.67 281.4C64.57 273.1 64 264.6 64 256C64 247.4 64.57 238.9 65.67 230.6L22.41 191.2C15.55 184.9 12.82 175.3 16.06 166.6C20.49 154.7 25.78 143.2 31.84 132.3L36.51 124.2C43.12 113.2 50.52 102.8 58.63 92.95C64.55 85.8 74.3 83.32 83.14 86.14L138.8 103.9C152.2 93.56 167 84.96 182.8 78.43L195.3 21.33C197.3 12.25 204.3 5.04 213.5 3.51C227.3 1.201 241.5 0 256 0C270.5 0 284.7 1.201 298.5 3.51C307.7 5.04 314.7 12.25 316.7 21.33L329.2 78.43C344.1 84.96 359.8 93.56 373.2 103.9L428.9 86.14C437.7 83.32 447.4 85.8 453.4 92.95C461.5 102.8 468.9 113.2 475.5 124.2L480.2 132.3C486.2 143.2 491.5 154.7 495.9 166.6V166.6zM256 336C300.2 336 336 300.2 336 255.1C336 211.8 300.2 175.1 256 175.1C211.8 175.1 176 211.8 176 255.1C176 300.2 211.8 336 256 336z"/></svg>                        </div>
                    </div>
                    <!-- 转发提示控件 -->
                    <div class="resend-tips" id="resend-tips" style="height: 0;" data-onresend="false">
                        <div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg></div>
                        <a>选择要转发的联系人：</a>
                        <div style="padding: 16px;cursor: pointer;" onclick="cancelResend()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg></div>
                    </div>
                    <!-- 搜索框 -->
                    <div class="friend-search">
                        <input id="seach-input" placeholder="搜索列表 ……" oninput="cancelSearch()">
                        <div onclick="searchInList();"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z"/></svg></div>
                    </div>
                    <!-- 搜索结果区 -->
                    <div id="friend-search-body" class="friend-search-body" style="display: none;"></div>
                    <!-- 好友和群列表 -->
                    <div id="friend-list-body" style="overflow-y: scroll;overflow-x: hidden;flex: 1;"></div>
                </div>
                <!-- 消息主框架 -->
                <div style="flex: 1;display: flex;flex-direction: column;padding: 0 0 0 20px;">
                    <!-- 消息顶栏 -->
                    <div class="msg-hander" style="display: none;" id="msg-hander">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M511.1 63.1v287.1c0 35.25-28.75 63.1-64 63.1h-144l-124.9 93.68c-7.875 5.75-19.12 .0497-19.12-9.7v-83.98h-96c-35.25 0-64-28.75-64-63.1V63.1c0-35.25 28.75-63.1 64-63.1h384C483.2 0 511.1 28.75 511.1 63.1z"/></svg>
                        <a>Title</a>
                        <div style="width: auto;cursor: pointer;" onclick="document.getElementById('msg-body').scrollTop = document.getElementById('msg-body').scrollHeight">
                            <svg style="width: 10px;margin-top: -3px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"/></svg>
                            <a style="font-size: 10px;margin-left: 5px;margin-right: 10px;margin-top: 6px;display: inline-block;">回到底部</a>
                        </div>
                    </div>
                    <!-- 状态提示区 -->
                    <div class="run-statue" id="run-statue"></div>
                    <!-- 消息显示区 -->
                    <div class="msg-body" id="msg-body" onscroll="msgBodyScroll()"></div>
                    <!-- 发送控件区 -->
                    <div class="sender">
                        <!-- 多选控件 -->
                        <div class="resender" id="resender" style="height: 0;" data-onchoice="false">
                            <div>
                                <div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M503.7 226.2l-176 151.1c-15.38 13.3-39.69 2.545-39.69-18.16V272.1C132.9 274.3 66.06 312.8 111.4 457.8c5.031 16.09-14.41 28.56-28.06 18.62C39.59 444.6 0 383.8 0 322.3c0-152.2 127.4-184.4 288-186.3V56.02c0-20.67 24.28-31.46 39.69-18.16l176 151.1C514.8 199.4 514.8 216.6 503.7 226.2z"/></svg></div>
                                <a>转发</a>
                            </div>
                            <div onclick="cancelChoice()">
                                <div><svg style="margin-left: -3px;margin-top: -5px;width: 25px;height: 25px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg></div>
                                <a>取消</a>
                            </div>
                        </div>
                        <!-- 回复提示控件 -->
                        <div class="replyer" id="replyer">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M8.31 189.9l176-151.1c15.41-13.3 39.69-2.509 39.69 18.16v80.05C384.6 137.9 512 170.1 512 322.3c0 61.44-39.59 122.3-83.34 154.1c-13.66 9.938-33.09-2.531-28.06-18.62c45.34-145-21.5-183.5-176.6-185.8v87.92c0 20.7-24.31 31.45-39.69 18.16l-176-151.1C-2.753 216.6-2.784 199.4 8.31 189.9z"/></svg>
                            <a id="replyer-txt"></a>
                            <div onclick="cancelReply()">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
                            </div>
                        </div>
                        <!-- 发送控件 -->
                        <div style="display: flex;" class="controller">
                            <label title="发送图片" onmouseout="showSelView(false);" onmouseover="showSelView(true);" class="ss-card" id="btn-img" data-select="false" onclick="selectImg();" style="height: 60px;margin-bottom: 0;transition: background .3s;cursor: pointer;background: var(--color-card-1);padding: 20px;min-height: unset;">
                                <div class="btn-img-hover" id="btn-img-hover" style="opacity: 0;display: none;"><img></div>
                                <svg style="width: 20px;height: 20px;margin-top: -7px;fill: var(--color-font);" style="transition: fill .3s;pointer-events: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M224 128L224 0H48C21.49 0 0 21.49 0 48v416C0 490.5 21.49 512 48 512h288c26.51 0 48-21.49 48-48V160h-127.1C238.3 160 224 145.7 224 128zM96 224c17.67 0 32 14.33 32 32S113.7 288 96 288S64 273.7 64 256S78.33 224 96 224zM318.1 439.5C315.3 444.8 309.9 448 304 448h-224c-5.9 0-11.32-3.248-14.11-8.451c-2.783-5.201-2.479-11.52 .7949-16.42l53.33-80C122.1 338.7 127.1 336 133.3 336s10.35 2.674 13.31 7.125L160 363.2l45.35-68.03C208.3 290.7 213.3 288 218.7 288s10.35 2.674 13.31 7.125l85.33 128C320.6 428 320.9 434.3 318.1 439.5zM256 0v128h128L256 0z"/></svg>
                                <input id="choice-pic" type="file" style="display: none;" onchange="selectImgFile()">
                            </label>
                            <form id="send-box-form" style="display: flex;flex: 1;height: 60px;margin-left: 20px;" onsubmit="return sendMsg();">
                                <div class="ss-card msg-box">
                                    <input id="send-box" type="text" autocomplete="off">
                                </div>
                                <button class="ss-card" title="发送" style="width: 60px;height: 60px;border: 0;margin-left: 20px;background: var(--color-main);">
                                    <svg style="fill: var(--color-font-r);width: 20px;height: 20px;margin-top: -4px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M511.6 36.86l-64 415.1c-1.5 9.734-7.375 18.22-15.97 23.05c-4.844 2.719-10.27 4.097-15.68 4.097c-4.188 0-8.319-.8154-12.29-2.472l-122.6-51.1l-50.86 76.29C226.3 508.5 219.8 512 212.8 512C201.3 512 192 502.7 192 491.2v-96.18c0-7.115 2.372-14.03 6.742-19.64L416 96l-293.7 264.3L19.69 317.5C8.438 312.8 .8125 302.2 .0625 289.1s5.469-23.72 16.06-29.77l448-255.1c10.69-6.109 23.88-5.547 34 1.406S513.5 24.72 511.6 36.86z"/></svg>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 页脚 -->
    <footer class="container-lg" id="footer" style="transition: transform .5s;">
        <div class="ss-card">
            <header>
                QQ Web Lite
            </header>
            <span>Copyright © 2020 - 2022 Stapx Steve [ 林槐 ]</span><br>
            <div style="float: right;margin-top: -44px;">
                <svg style="width: 50px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 274 259">
                    <g id="圖層_2" data-name="圖層 2">
                        <g id="本体">
                            <rect class="cls-1" x="19" y="167" width="28" height="28" />
                            <rect class="cls-1" x="62" y="181" width="14" height="14" />
                            <rect class="cls-1" x="89" y="163" width="14" height="14" />
                            <rect class="cls-1" x="62" y="63" width="14" height="14" />
                            <rect class="cls-1" x="82" y="85" width="14" height="14" />
                            <rect class="cls-1" x="114" y="66" width="28" height="28" />
                            <polygon class="cls-1"
                                     points="112.54 153.5 33.5 153.5 33.5 106.5 155 106.5 155.5 106.5 159.37 106.5 159.46 207.5 159.5 254.36 159.5 254.46 144.5 254.47 144.5 254.37 144.5 238.5 116.5 238.5 116.5 254.4 116.5 254.5 112.63 254.5 112.63 254.4 3.54 254.5 3.5 207.64 112.59 207.54 112.54 153.5" />
                            <polygon class="cls-1"
                                     points="183.51 114.5 198.5 114.5 198.5 130.5 198.5 131.49 269.5 131.42 269.48 103.5 219.5 103.55 219.5 85.47 269.5 85.42 269.5 84.5 269.5 36.42 269.5 20.5 269.48 20.5 251.5 20.5 251.5 5.52 251.5 5.5 232.5 5.5 232.5 5.53 183.5 5.58 183.53 36.5 232.5 36.45 232.5 54.53 219.5 54.55 219.5 54.5 182.5 54.5 182.5 114.5 183.51 114.5" />
                            <rect class="cls-1" x="242" y="153" width="28" height="28" />
                            <rect class="cls-1" x="183" y="240" width="14" height="14" />
                            <rect class="cls-1" x="204" y="166" width="26" height="14" />
                            <rect class="cls-1" x="183" y="190" width="14" height="41" />
                            <polygon class="cls-1"
                                     points="269.5 189.5 269.5 230.62 245.62 254.5 203.5 254.5 203.5 189.5 269.5 189.5" />
                            <rect class="cls-1" width="8" height="8" />
                            <rect class="cls-1" x="266" y="251" width="8" height="8" />
                            <polygon class="cls-1"
                                     points="3.5 33.16 30.77 5.5 50.5 5.5 145.5 5.5 145.5 19.5 159.5 19.5 159.5 52.5 50.5 52.5 50.5 153.5 3.5 153.5 3.5 52.5 3.5 33.16" />
                        </g>
                    </g>
                </svg>
            </div>
        </div>
        <div>
        </div>
    </footer>

    <!-- 登录弹窗 -->
    <div class="login-pan" id="login-pan" style="display: none;opacity: 0;">
        <div class="login-pan-bg" onclick="showLoginPan(false)"></div>
        <div class="login-pan-card ss-card">
            <p>连接到 OICQ/OneBot</p>
            <a>连接到 WebSocket 服务开始使用</a>
            <input placeholder="连接地址" class="ss-input" id="sev_address">
            <input placeholder="许可令牌" class="ss-input" style="margin-top: 10px;" id="access_token">
            <button class="ss-button" onclick="runConnect();">连接</button>
        </div>
    </div>
    <!-- 图片预览器 -->
    <div class="img-view" id="img-view">
        <div></div><div onclick="openImgView();"><img></div>
    </div>
    <!-- 右击菜单 -->
    <div class="right-click-menu" id="right-click-menu" style="display: none;" oncontextmenu="return false;">
        <div id="right-click-menu-bg"></div>
        <div class="ss-card menu" id="right-click-menu-body">
            <div onclick="menuReply()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M511.1 63.1v287.1c0 35.25-28.75 63.1-64 63.1h-144l-124.9 93.68c-7.875 5.75-19.12 .0497-19.12-9.7v-83.98h-96c-35.25 0-64-28.75-64-63.1V63.1c0-35.25 28.75-63.1 64-63.1h384C483.2 0 511.1 28.75 511.1 63.1z"/></svg>
                <a>回复</a>
            </div>
            <div onclick="menuResend()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M503.7 226.2l-176 151.1c-15.38 13.3-39.69 2.545-39.69-18.16V272.1C132.9 274.3 66.06 312.8 111.4 457.8c5.031 16.09-14.41 28.56-28.06 18.62C39.59 444.6 0 383.8 0 322.3c0-152.2 127.4-184.4 288-186.3V56.02c0-20.67 24.28-31.46 39.69-18.16l176 151.1C514.8 199.4 514.8 216.6 503.7 226.2z"/></svg>
                <a>转发</a>
            </div>
            <div onclick="menuChoice()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M318.4 304.5c-3.531 9.344-12.47 15.52-22.45 15.52h-105l45.15 94.82c9.496 19.94 1.031 43.8-18.91 53.31c-19.95 9.504-43.82 1.035-53.32-18.91L117.3 351.3l-75 88.25c-4.641 5.469-11.37 8.453-18.28 8.453c-2.781 0-5.578-.4844-8.281-1.469C6.281 443.1 0 434.1 0 423.1V56.02c0-9.438 5.531-18.03 14.12-21.91C22.75 30.26 32.83 31.77 39.87 37.99l271.1 240C319.4 284.6 321.1 295.1 318.4 304.5z"/></svg>
                <a>多选</a>
            </div>
            <div onclick="menuCancel()" id="menuCancel">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
                <a>撤回</a>
            </div>
            <div id="menuCopy">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M336 64h-53.88C268.9 26.8 233.7 0 192 0S115.1 26.8 101.9 64H48C21.5 64 0 85.48 0 112v352C0 490.5 21.5 512 48 512h288c26.5 0 48-21.48 48-48v-352C384 85.48 362.5 64 336 64zM192 64c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S160 113.7 160 96C160 78.33 174.3 64 192 64zM272 224h-160C103.2 224 96 216.8 96 208C96 199.2 103.2 192 112 192h160C280.8 192 288 199.2 288 208S280.8 224 272 224z"/></svg>
                <a>复制</a>
            </div>
        </div>
    </div>
</div>
</body>

<!-- 懒得再挪个文件出来的功能 -->
<script>
    // 自动暗黑模式标志
    window.is_auto_dark = true
    // 初始化颜色切换按钮
    let mediaTest = window.matchMedia('(prefers-color-scheme: dark)');
    if(is_auto_dark !== false) {
        if (mediaTest.matches) {
            document.getElementById("color-changer").dataset.color = "dark"
            document.getElementById("color-changer").innerHTML = String.raw`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>`
        }
    }
    // SW 特性支持
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js', { scope: './' }).then(function(reg) {
            console.log('注册 Service Workers 服务成功：' + reg.scope);
        }).catch(function(error) {
            console.log('注册 Service Workers 服务失败：' + error);
        });
    }
    // 覆写粘贴事件，提供粘贴图片的功能
    document.getElementById("send-box").addEventListener("paste", function(e) {
        // 判断粘贴类型
        if (!(e.clipboardData && e.clipboardData.items)) {
            return
        }
        for (var i = 0, len = e.clipboardData.items.length; i < len; i++) {
            var item = e.clipboardData.items[i]
            if (item.kind === "file") {
                console.log("file")
                var blob = item.getAsFile()
                if(blob.type.indexOf("image/") >= 0 && blob.size != 0) {
                    setStatue("load", "正在处理图片 ……")
                    if(blob.size < 3145728) {
                        // 转换为 Base64
                        var reader = new FileReader();
                        reader.readAsDataURL(blob); 
                        reader.onloadend = function() {
                            var base64data = reader.result
                            // 将按钮改为选中状态
                            document.getElementById("btn-img").style.background = "var(--color-main)"
                            document.getElementById("btn-img").children[1].style.fill = "var(--color-font-r)"
                            document.getElementById("btn-img").title = "取消发送图片"
                            // 记录图片信息
                            window.cacheImg = base64data
                            // 设置标记
                            document.getElementById("btn-img").dataset.select = "true"
                            // 完成
                            setStatue("ok", "图片处理完成！")
                            // 删除 input
                            document.getElementById("btn-img").removeChild(document.getElementById("choice-pic"))
                        }
                    } else {
                        // 图片过大
                        setStatue("err", "图片过大！")
                    }
                }
                //阻止默认行为
                e.preventDefault();
            }
        }
    })
    // 复制消息
    var clipboard = new ClipboardJS(document.getElementById("menuCopy"), {
        text: function(trigger) {
            return (window.msgInMenu != undefined && window.msgInMenu != null)?window.msgInMenu.dataset.raw:""
        }
    });
    clipboard.on('success', function(e) {
        showMsgMenu()
    });
    clipboard.on('error', function(e) {
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        setStatue("err", "复制消息失败！")
    });
</script>

<!-- 外部附加功能依赖 -->
<script src="https://api.stapxs.cn/js/util/jquery-1.12.4.js"></script>
<script src="https://api.stapxs.cn/bootstrap/popper.min.js"></script>
<script src="https://api.stapxs.cn/bootstrap/bootstrap.min.js"></script>
<script src="https://api.stapxs.cn/js/auto-theme.js"></script>

</html>